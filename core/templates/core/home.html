{% extends 'core/base.html' %}
{% load static %}
{% block body_class %}homepage{% endblock %}
{% block content %}
<!-- Live Stream Banner -->
{% if site_config.is_live_now %}
<a
  href="{{ site_config.live_stream_url }}"
  target="_blank"
  class="live-banner reveal"
>
  <span class="pulse-icon"></span>
  LIVE NOW: Join the Service &rarr;
</a>
{% endif %}

<!-- Hero Section (YMR Style) -->
<section
  class="hero-ymr reveal"
  style="
    position: relative;
    padding: 8rem 1.5rem 6rem;
    text-align: center;
    background: linear-gradient(rgba(10, 25, 47, 0.85), rgba(10, 25, 47, 0.9)),
      url('{% static 'core/img/logo_branding.png' %}');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    color: white;
    min-height: 80vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    margin-top: -80px; /* Pull up to sit behind navbar */
    padding-top: calc(8rem + 80px); /* Compensate for negative margin */
  "
>
  <!-- Fallback if no image -->
  <div
    style="
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background: #0a192f;
    "
  ></div>

  <span
    style="
      color: var(--primary);
      letter-spacing: 2px;
      text-transform: uppercase;
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 1rem;
    "
  >
    Welcome to The Truth Gate
  </span>

  <h1
    style="
      font-family: var(--font-heading);
      font-size: clamp(2.5rem, 5vw, 4.5rem);
      line-height: 1.1;
      margin-bottom: 1.5rem;
      max-width: 900px;
    "
  >
    {{ site_config.hero_headline|default:"Igniting a Burning Generation On Fire For Jesus" }}
  </h1>

  <p
    style="
      font-size: 1.2rem;
      color: rgba(255, 255, 255, 0.8);
      max-width: 600px;
      margin-bottom: 2.5rem;
      line-height: 1.6;
    "
  >
    {{ site_config.hero_subtext|default:"We are a global movement raising a passionate generation empowered to influence nations with the fire and truth of Jesus." }}
  </p>

  <div
    style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center"
  >
    <a
      href="{% url 'sermon_list' %}"
      class="btn-primary"
      style="background: white; color: var(--secondary); border: none"
    >
      Explore Sermons
    </a>
    <a
      href="{% url 'give' %}"
      class="btn-primary"
      style="
        background: transparent;
        border: 2px solid var(--primary);
        color: white;
      "
    >
      Partner With Us
    </a>
  </div>
</section>

<!-- Vision & Mission Section -->
<section
  class="reveal"
  style="padding: 6rem 1.5rem; background: var(--bg-body)"
>
  <div class="container" style="max-width: 1100px">
    <!-- Vision -->
    <div
      style="
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 4rem;
        margin-bottom: 6rem;
        align-items: center;
      "
    >
      <div>
        <div
          style="
            width: 50px;
            height: 5px;
            background: var(--primary);
            margin-bottom: 1.5rem;
          "
        ></div>
        <h2
          style="
            font-family: var(--font-heading);
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 1.5rem;
          "
        >
          {{ site_config.vision_title|default:"Our Vision" }}
        </h2>
        <p
          style="
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-secondary);
          "
        >
          {{ site_config.vision_text|default:"Raising a Burning Generation. Empowering young believers to live passionately for Jesus and impact their world with unshakable kingdom fire." }}
        </p>
      </div>
      <!-- Mission Cards -->
      <div style="display: grid; gap: 1.5rem">
        <div
          class="glass-card"
          style="padding: 2rem; border-left: 4px solid var(--primary)"
        >
          <h3 style="color: var(--secondary); margin-bottom: 1rem">
            {{ site_config.mission_title|default:"Our Mission" }}
          </h3>
          <p style="color: var(--text-secondary)">
            {{ site_config.mission_text|default:"Raising, Building and Equipping People as Kingdom Ambassadors in Every Sphere of Human Influence" }}
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Partner/Give Section -->
<section
  class="reveal"
  style="
    padding: 6rem 1.5rem;
    background: var(--secondary);
    color: white;
    text-align: center;
  "
>
  <div class="container" style="max-width: 800px">
    <h2
      style="
        font-family: var(--font-heading);
        font-size: 2.5rem;
        margin-bottom: 1.5rem;
        color: white;
      "
    >
      Partner With The Vision
    </h2>
    <p
      style="
        font-size: 1.1rem;
        color: rgba(255, 255, 255, 0.8);
        margin-bottom: 3rem;
      "
    >
      Your giving fuels the mandate to raise a burning generation. Join us in
      advancing the Kingdom.
    </p>
    <a
      href="{% url 'give' %}"
      class="btn-primary"
      style="
        background: var(--primary);
        color: white;
        border: none;
        padding: 1rem 3rem;
        font-size: 1.1rem;
      "
    >
      Give Now
    </a>
  </div>
</section>

<!-- Testimonies Section (Kept for Social Proof) -->
<section class="reveal" style="padding: 6rem 1.5rem">
  <div style="text-align: center; margin-bottom: 3rem">
    <h3 style="font-size: 2rem; margin-bottom: 0.5rem; color: var(--secondary)">
      Stories of Grace
    </h3>
    <p style="color: var(--text-secondary)">
      See how God is moving in our lives.
    </p>
  </div>
  {% if testimonies %}
  <div
    style="
      display: flex;
      overflow-x: auto;
      gap: 1.5rem;
      padding: 1rem;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 2rem; /* Scrollbar space */
    "
  >
    {% for testimony in testimonies %}
    <a
      href="{% url 'testimony_detail' testimony.pk %}"
      class="glass-card"
      style="
        display: block;
        text-decoration: none;
        min-width: 320px;
        padding: 2.5rem;
        scroll-snap-align: center;
        background: #ffffff;
        border: 1px solid var(--border-color);
      "
    >
      <p
        style="
          font-size: 1.1rem;
          color: var(--text-primary);
          font-style: italic;
          margin-bottom: 1.5rem;
          line-height: 1.6;
        "
      >
        "{{ testimony.content|truncatewords:25 }}"
      </p>
      <div style="display: flex; align-items: center; gap: 0.75rem">
        <div
          style="
            width: 40px;
            height: 40px;
            background: var(--primary-dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #ffffff; /* White text on dark accent */
          "
        >
          {{ testimony.name|slice:":1" }}
        </div>
        <div>
          <strong
            style="display: block; font-size: 0.9rem; color: var(--primary)"
            >{{ testimony.name|default:"Anonymous" }}</strong
          >
          <span style="font-size: 0.8rem; color: var(--text-secondary)"
            >{{ testimony.location|default:"Member" }}</span
          >
        </div>
      </div>
    </a>
    {% endfor %}
  </div>
  {% else %}
  <div
    class="glass-card"
    style="padding: 3rem; text-align: center; max-width: 600px; margin: 0 auto"
  >
    <p style="margin-bottom: 1.5rem; color: var(--text-secondary)">
      God is moving in our midst. Use your story to encourage others.
    </p>
    <a href="{% url 'submit_testimony' %}" class="btn-primary"
      >Share Your Testimony</a
    >
  </div>
  {% endif %}
</section>

<style>
  /* Local Styles V2 */
  .live-banner {
    display: flex;
    justify-content: center;
    align-items: center;
    background: rgba(220, 38, 38, 0.95); /* Deeper Red */
    backdrop-filter: blur(8px);
    color: white;
    padding: 0.75rem;
    text-decoration: none;
    font-weight: 600;
    font-size: 0.9rem;
    letter-spacing: 0.05em;
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .pulse-icon {
    display: inline-block;
    width: 8px;
    height: 8px;
    background: white;
    border-radius: 50%;
    margin-right: 10px;
    animation: pulse 2s infinite; /* Slower pulse */
  }

  @keyframes pulse {
    0% {
      transform: scale(0.95);
      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7);
    }
    70% {
      transform: scale(1);
      box-shadow: 0 0 0 6px rgba(255, 255, 255, 0);
    }
    100% {
      transform: scale(0.95);
      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);
    }
  }

  .topic-card-v2:hover {
    transform: translateY(-2px); /* Reduced movement */
    box-shadow: var(--shadow-soft);
  }
</style>
{% endblock %}