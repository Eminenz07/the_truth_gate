{% extends 'core/base.html' %} {% load static %} {% block body_class%}homepage{%endblock %} {% block content %}




<!-- Hero Section (YMR Style) -->
<section class="hero-home reveal" style="position: relative; overflow: hidden">
  <!-- Video Background -->
  <video
    autoplay
    muted
    playsinline
    id="hero-video"
    style="
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -1;
      filter: brightness(0.6); /* Darken for text readability */
    "
  >
    <source src="{% static 'core/img/branding.mp4' %}" type="video/mp4" />
  </video>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const video = document.getElementById("hero-video");
      let playCount = 1; // Starts with autoplay
      const maxPlays = 3;

      if(video) {
        // Defensive: Force loop off
        video.loop = false;
        video.removeAttribute('loop');
        
        console.log("Video initialized. Play count: " + playCount);

        video.addEventListener('ended', function() {
          if (playCount < maxPlays) {
            playCount++;
            console.log("Replaying video. Play count: " + playCount);
            video.play();
          } else {
            console.log("Max plays reached. Stopping video.");
            video.pause(); // Just to be sure
          }
        });
      }
    });
  </script>

  <span class="hero-subtitle"> Welcome to The Truth Gate </span>

  <!-- Live Stream Banner -->
  {% if site_config.is_live_now %}
  <a
    href="{{ site_config.live_stream_url }}"
    target="_blank"
    class="live-banner reveal"
    style="margin-bottom: 2rem; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; background: #e63946; color: white; padding: 0.5rem 1.5rem; border-radius: 50px; text-decoration: none; font-weight: 600;"
  >
    <span class="pulse-icon" style="height: 10px; width: 10px; background: white; border-radius: 50%; display: inline-block; animation: pulse 1.5s infinite;"></span>
    LIVE NOW: Join the Service &rarr;
  </a>
  <style>
      @keyframes pulse {
          0% { opacity: 1; transform: scale(1); }
          50% { opacity: 0.5; transform: scale(1.2); }
          100% { opacity: 1; transform: scale(1); }
      }
  </style>
  {% endif %}



  <h1 class="hero-title">
    {{ site_config.hero_headline|default:"Igniting a Burning Generation On Fire For Jesus" }}
  </h1>

  <p class="hero-text">
    {{ site_config.hero_subtext|default:"We are a global movement raising a passionate generation empowered to influence nations with the fire and truth of Jesus." }}
  </p>

  <div class="hero-actions">
    <a href="{% url 'sermon_list' %}" class="hero-btn-primary">
      Explore Sermons
    </a>
    {% if not user.is_authenticated %}
    <a href="{% url 'signup' %}" class="btn-outline-white">
      Join the Community
    </a>
    {% endif %}
  </div>
  </div>
</section>

<!-- What We Do Section -->
<section
  class="reveal"
  style="padding: 6rem 1.5rem; background: transparent; text-align: center"
>
  <div class="container" style="max-width: 1100px">
    <div
      style="
        width: 50px;
        height: 5px;
        background: var(--primary);
        margin: 0 auto 1.5rem;
      "
    ></div>
    <h2
      style="
        font-family: var(--font-heading);
        font-size: 2.5rem;
        color: var(--secondary);
        margin-bottom: 3rem;
      "
    >
      What We Do
    </h2>

    <div
      style="
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
      "
    >
      <!-- Raising -->
      <div
        class="glass-card reveal"
        style="
          padding: 2.5rem;
          border-top: 4px solid var(--primary);
          text-align: left;
          transition-delay: 0.1s;
        "
      >
        <div style="margin-bottom: 1.5rem; color: var(--primary);">
            <i class="material-icons-round" style="font-size: 3rem;">local_fire_department</i>
        </div>
        <h3 style="color: var(--secondary); margin-bottom: 1rem">Raising</h3>
        <p style="color: var(--text-secondary)">
          Raising a burning generation of believers who are passionate for Jesus.
        </p>
      </div>

      <!-- Building -->
      <div
        class="glass-card reveal"
        style="
          padding: 2.5rem;
          border-top: 4px solid var(--accent);
          text-align: left;
          transition-delay: 0.2s;
        "
      >
        <div style="margin-bottom: 1.5rem; color: var(--accent);">
            <i class="material-icons-round" style="font-size: 3rem;">apartment</i>
        </div>
        <h3 style="color: var(--secondary); margin-bottom: 1rem">Building</h3>
        <p style="color: var(--text-secondary)">
          Building strong kingdom foundations in every sphere of influence.
        </p>
      </div>

      <!-- Equipping -->
      <div
        class="glass-card reveal"
        style="
          padding: 2.5rem;
          border-top: 4px solid var(--primary);
          text-align: left;
          transition-delay: 0.3s;
        "
      >
        <div style="margin-bottom: 1.5rem; color: var(--primary);">
            <i class="material-icons-round" style="font-size: 3rem;">school</i>
        </div>
        <h3 style="color: var(--secondary); margin-bottom: 1rem">Equipping</h3>
        <p style="color: var(--text-secondary)">
          Equipping saints for the work of ministry and global impact.
        </p>
      </div>
    </div>
  </div>
</section>

<!-- Vision & Mission Section -->
<section
  id="about"
  class="reveal"
  style="padding: 6rem 1.5rem; background: transparent;"
>
  <div class="container" style="max-width: 1100px">
    
    <div
      style="
        width: 50px;
        height: 5px;
        background: var(--primary);
        margin: 0 auto 1.5rem;
      "
    ></div>
    <h2
        style="
        font-family: var(--font-heading);
        font-size: 2.5rem;
        color: var(--secondary);
        margin-bottom: 3rem;
        text-align: center;
        "
    >
        Vision & Mission
    </h2>

    <div
      style="
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 3rem;
        align-items: stretch;
      "
    >
      <!-- Vision Card -->
      <div
        class="reveal"
        style="
          background: var(--primary);
          color: white;
          padding: 3rem;
          border-radius: 12px;
          box-shadow: var(--shadow-lg);
          transition-delay: 0.1s;
          position: relative;
          overflow: hidden;
        "
      >
        <div style="margin-bottom: 1.5rem; opacity: 0.8;">
            <i class="material-icons-round" style="font-size: 4rem; color: var(--accent);">visibility</i>
        </div>
        <h2
          style="
            font-family: var(--font-heading);
            font-size: 2rem;
            color: var(--accent);
            margin-bottom: 1.5rem;
          "
        >
          {{ site_config.vision_title|default:"Our Vision" }}
        </h2>
        <p style="font-size: 1.1rem; line-height: 1.8; opacity: 0.9">
          {{ site_config.vision_text|default:"Raising a Burning Generation. Empowering young believers to live passionately for Jesus and impact their world with unshakable kingdom fire." }}
        </p>
      </div>

      <!-- Mission Card -->
      <div
        class="reveal glass-card"
        style="
          padding: 3rem;
          border-radius: 12px;
          border-left: 6px solid var(--accent);
          box-shadow: var(--shadow-lg);
          display: flex;
          flex-direction: column;
          justify-content: center;
          transition-delay: 0.3s;
        "
      >
        <div style="margin-bottom: 1.5rem; color: var(--secondary);">
            <i class="material-icons-round" style="font-size: 4rem;">flag</i>
        </div>
        <h3
          style="
            color: var(--secondary);
            margin-bottom: 1rem;
            font-size: 1.8rem;
          "
        >
          {{ site_config.mission_title|default:"Our Mission" }}
        </h3>
        <p
          style="
            color: var(--text-secondary);
            font-size: 1.1rem;
            line-height: 1.8;
          "
        >
          {{ site_config.mission_text|default:"Raising, Building and Equipping People as Kingdom Ambassadors in Every Sphere of Human Influence" }}
        </p>
      </div>
    </div>
  </div>
</section>

<!-- Testimonies Section (Kept for Social Proof) -->
<section class="reveal" style="padding: 6rem 1.5rem; background: transparent">
  <div class="container" style="max-width: 1200px">
    <!-- Section Card -->
    <div
      style="
        /* REMOVED: background: var(--bg-body); */
        /* REMOVED: border-radius: 24px; */
        /* UPDATED PADDING: Removed massive padding to match Vision & Mission */
        /* padding: 4rem 2rem; -> Removed */
        /* REMOVED: box-shadow: ... */
        /* REMOVED: border: ... */
      "
    >
      <!-- Header -->
      <div
        style="
          text-align: center;
          margin-bottom: 3rem;
          max-width: 600px;
          margin-left: auto;
          margin-right: auto;
        "
      >
        <h3
          style="
            font-size: 2.25rem;
            margin-bottom: 1rem;
            color: var(--secondary);
            font-family: var(--font-heading);
          "
        >
          Stories of Grace
        </h3>
        <p
          style="
            color: var(--text-secondary);
            font-size: 1.1rem;
            line-height: 1.6;
          "
        >
          See how God is moving in our lives. These testimonies are a testament to His faithfulness.
        </p>
      </div>

      <!-- Testimonies List -->
      {% if testimonies %}
      <div
        style="
          display: flex;
          overflow-x: auto;
          gap: 1.5rem;
          padding: 1rem 0.5rem;
          scroll-snap-type: x mandatory;
          -webkit-overflow-scrolling: touch;
          padding-bottom: 2rem;
          margin-bottom: 2rem;
        "
      >
        {% for testimony in testimonies %}
        <a
          href="{% url 'testimony_detail' testimony.pk %}"
          class="glass-card topic-card-v2"
          style="
            display: block;
            text-decoration: none;
            min-width: 340px;
            padding: 2.5rem;
            scroll-snap-align: center;
            border-radius: 16px;
            transition: transform 0.2s, box-shadow 0.2s;
          "
        >
          <div style="margin-bottom: 1.5rem">
            <span
              style="
                font-size: 3rem;
                line-height: 1;
                color: var(--accent);
                opacity: 0.3;
                font-family: serif;
              "
              >&ldquo;</span
            >
          </div>
          <p
            style="
              font-size: 1.1rem;
              color: var(--text-primary);
              font-style: italic;
              margin-bottom: 1.5rem;
              line-height: 1.6;
              min-height: 80px;
            "
          >
            {{ testimony.content|truncatewords:25 }}
          </p>
          <div
            style="
              display: flex;
              align-items: center;
              gap: 0.75rem;
              border-top: 1px solid var(--border-color);
              padding-top: 1rem;
            "
          >
            <div
              style="
                width: 45px;
                height: 45px;
                background: var(--primary);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: 700;
                color: #ffffff;
                font-size: 1.1rem;
              "
            >
              {{ testimony.name|slice:":1" }}
            </div>
            <div>
              <strong
                style="display: block; font-size: 1rem; color: var(--secondary)"
                >{{ testimony.name|default:"Anonymous" }}</strong
              >
              <span style="font-size: 0.85rem; color: var(--text-secondary)">{{ testimony.location|default:"Member" }}</span
              >
            </div>
          </div>
        </a>
        {% endfor %}
      </div>

      <!-- Action Buttons -->
      <div
        style="
          text-align: center;
          display: flex;
          gap: 1rem;
          justify-content: center;
          flex-wrap: wrap;
        "
      >
        <a
          href="{% url 'testimony_list' %}"
          class="btn-primary"
          style="padding: 0.75rem 2rem"
        >
          Read More Stories
        </a>
        <a
          href="{% url 'submit_testimony' %}"
          class="btn-outline"
          style="padding: 0.75rem 2rem; background: white"
        >
          Share Your Story
        </a>
      </div>

      {% else %}
      <div
        style="
          padding: 4rem;
          text-align: center;
          max-width: 600px;
          margin: 0 auto;
        "
      >
        <p
          style="
            margin-bottom: 2rem;
            color: var(--text-secondary);
            font-size: 1.1rem;
          "
        >
          God is moving in our midst. We are waiting to hear your story.
        </p>
        <a href="{% url 'submit_testimony' %}" class="btn-primary">Share Your Testimony</a>
      </div>
      {% endif %}
    </div>
  </div>
</section>

<style>
  /* Local Styles V2 */
  .live-banner {
    display: flex;
    justify-content: center;
    align-items: center;
    background: rgba(220, 38, 38, 0.95); /* Deeper Red */
    backdrop-filter: blur(8px);
    color: white;
    padding: 0.75rem;
    text-decoration: none;
    font-weight: 600;
    font-size: 0.9rem;
    letter-spacing: 0.05em;
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .pulse-icon {
    display: inline-block;
    width: 8px;
    height: 8px;
    background: white;
    border-radius: 50%;
    margin-right: 10px;
    animation: pulse 2s infinite; /* Slower pulse */
  }

  @keyframes pulse {
    0% {
      transform: scale(0.95);
      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7);
    }
    70% {
      transform: scale(1);
      box-shadow: 0 0 0 6px rgba(255, 255, 255, 0);
    }
    100% {
      transform: scale(0.95);
      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);
    }
  }

  .topic-card-v2:hover {
    transform: translateY(-2px); /* Reduced movement */
    box-shadow: var(--shadow-soft);
  }
</style>
{% endblock %}
