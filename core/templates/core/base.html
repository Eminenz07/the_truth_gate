<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}The Truth Gate{% endblock %}</title>
    <link
      rel="icon"
      href="{% static 'core/img/logo_branding.png' %}"
      type="image/png"
    />
    <link rel="stylesheet" href="{% static 'core/css/theme.css' %}" />
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons+Round"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body class="{% block body_class %}{% endblock %}">
    <!-- Mobile Header (Sticky Glass) -->
    <header
      class="mobile-header glass-card"
      style="
        border-radius: 0;
        border-left: none;
        border-right: none;
        border-top: none;
      "
    >
      <button class="icon-btn" onclick="toggleMobileMenu()">
        <span class="material-icons-round">menu</span>
      </button>
      <a
        href="{% url 'home' %}"
        class="brand-logo"
        style="
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          text-decoration: none;
        "
      >
        <img
          src="{% static 'core/img/logo_branding.png' %}"
          alt="The Truth Gate"
          style="height: 48px; width: auto"
        />
        <span
          style="
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            letter-spacing: 1px;
            color: var(--text-primary);
          "
          >THE TRUTH GATE</span
        >
      </a>
      <div class="header-actions">
        {% if not user.is_authenticated %}
        <a href="{% url 'login' %}" class="icon-btn"
          ><span class="material-icons-round">account_circle</span></a
        >
        {% endif %}
      </div>
    </header>

    <!-- Desktop Header (Transparent) -->
    <header class="site-header desktop-only">
      <div
        class="container relative"
        style="
          flex-direction: row;
          justify-content: space-between;
          align-items: center;
          max-width: 1000px;
        "
      >
        <div style="text-align: left">
          <a
            href="{% url 'home' %}"
            class="logo"
            style="
              margin-bottom: 0;
              display: flex;
              align-items: center;
              gap: 1rem;
              text-decoration: none;
            "
          >
            <img
              src="{% static 'core/img/logo_branding.png' %}"
              alt="The Truth Gate"
              style="height: 64px; width: auto"
            />
            <span
              class="brand-text"
              style="
                font-family: 'Playfair Display', serif;
                font-weight: 700;
                font-size: 1.5rem;
              "
              >The Truth Gate</span
            >
          </a>
          <p class="tagline" style="margin-bottom: 0">
            Ye shall know the truth
          </p>
        </div>

        <ul
          class="site-nav"
          style="margin: 0; gap: 2rem !important; align-items: center"
        >
          <li><a href="{% url 'home' %}">Home</a></li>
          <li class="dropdown-wrapper">
            <a href="#" class="dropdown-trigger">
              Counseling
              <i
                class="fas fa-chevron-down"
                style="font-size: 0.8rem; margin-left: 4px"
              ></i>
            </a>
            <div class="dropdown-menu glass-card">
              <a href="{% url 'contact' %}">Counsel</a>
              <a href="{% url 'prayer_request' %}">Prayer Requests</a>
              <a href="{% url 'contact' %}">Contact</a>
            </div>
          </li>
          <!-- Placeholder for now -->
          <li><a href="{% url 'event_list' %}">Events</a></li>
          <li><a href="{% url 'give' %}">Donate</a></li>

          <li class="dropdown-wrapper">
            <a href="#" class="dropdown-trigger"
              >Resources
              <i
                class="fas fa-chevron-down"
                style="font-size: 0.8rem; margin-left: 4px"
              ></i
            ></a>
            <div class="dropdown-menu glass-card">
              <a href="#">Watch Live</a>
              <!-- Needs Live link -->
              <a href="{% url 'sermon_list' %}">Sermon Library</a>
              <a href="{% url 'testimony_list' %}">Testimonies</a>
            </div>
          </li>

      </div>
    </header>

    <!-- Mobile Drawer -->
    <div class="mobile-overlay" onclick="toggleMobileMenu()"></div>
    <nav
      class="mobile-drawer"
      style="
        padding: 2rem 1.5rem;
        background: var(--bg-body);
        border-right: 1px solid var(--border-color);
      "
    >
      <div
        style="
          margin-bottom: 2rem;
          padding-bottom: 1rem;
          border-bottom: 1px solid var(--border-color);
        "
      >
        <span
          style="
            font-family: var(--font-heading);
            font-size: 1.5rem;
            color: var(--text-primary);
          "
          >The Truth Gate</span
        >
      </div>

      <div style="display: flex; flex-direction: column; gap: 0.5rem">
        <a
          href="{% url 'home' %}"
          style="
            padding: 0.75rem 0;
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--text-primary);
            text-decoration: none;
          "
          >Home</a
        >

        <div
          style="
            margin-top: 1rem;
            font-size: 0.8rem;
            text-transform: uppercase;
            color: var(--text-secondary);
            letter-spacing: 0.05em;
            font-weight: 600;
          "
        >
          Content
        </div>
        <a
          href="{% url 'sermon_list' %}"
          style="
            padding: 0.5rem 0;
            font-size: 1rem;
            color: var(--text-primary);
            text-decoration: none;
          "
          >Sermons</a
        >
        <a
          href="{% url 'event_list' %}"
          style="
            padding: 0.5rem 0;
            font-size: 1rem;
            color: var(--text-primary);
            text-decoration: none;
          "
          >Events</a
        >

        <div
          style="
            margin-top: 1rem;
            font-size: 0.8rem;
            text-transform: uppercase;
            color: var(--text-secondary);
            letter-spacing: 0.05em;
            font-weight: 600;
          "
        >
          Connect
        </div>
        <a
          href="{% url 'give' %}"
          style="
            padding: 0.5rem 0;
            font-size: 1rem;
            color: var(--text-primary);
            text-decoration: none;
          "
          >Give</a
        >
        <a
          href="{% url 'prayer_request' %}"
          style="
            padding: 0.5rem 0;
            font-size: 1rem;
            color: var(--text-primary);
            text-decoration: none;
          "
          >Prayer</a
        >
        <a
          href="{% url 'contact' %}"
          style="
            padding: 0.5rem 0;
            font-size: 1rem;
            color: var(--text-primary);
            text-decoration: none;
          "
          >Contact</a
        >

        <div
          style="
            margin-top: 1rem;
            border-top: 1px solid var(--border-color);
            padding-top: 1rem;
          "
        >

      </div>
    </nav>

    <main class="site-main">
      {% if messages %}
      <div class="container" style="max-width: 800px; margin: 2rem auto 1rem;">
        {% for message in messages %}
        <div
          class="flash-message"
          style="
            background: var(--bg-card); /* Solid background */
            color: var(--text-primary);
            padding: 1rem 1.5rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-left: 5px solid {% if message.tags == 'success' %}#10b981{% elif message.tags == 'error' %}#ef4444{% else %}var(--accent){% endif %};
            display: flex;
            align-items: center;
            gap: 1rem;
            opacity: 1; /* Ensure visibility */
            position: relative;
            z-index: 50; /* Ensure on top */
          "
        >
          {% if message.tags == 'success' %}
          <span class="material-icons-round" style="color: #10b981">check_circle</span>
          {% elif message.tags == 'error' %}
          <span class="material-icons-round" style="color: #ef4444">error</span>
          {% else %}
          <span class="material-icons-round" style="color: var(--accent)">info</span>
          {% endif %}
          <span style="font-size: 1rem; font-weight: 500;">{{ message }}</span>
        </div>
        {% endfor %}
      </div>
      {% endif %} {% block content %}{% endblock %}
    </main>

    <footer
      class="site-footer"
      style="
        background: var(--bg-body);
        color: var(--text-primary);
        padding: 4rem 1.5rem;
        border-top: 1px solid var(--border-color);
      "
    >
      <div
        class="container"
        style="
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 2rem;
        "
      >
        <!-- Brand Column -->
        <div>
          <a
            href="{% url 'home' %}"
            style="
              display: flex;
              align-items: center;
              gap: 0.75rem;
              text-decoration: none;
              margin-bottom: 1rem;
            "
          >
            <img
              src="{% static 'core/img/logo_branding.png' %}"
              alt="Logo"
              style="height: 48px"
            />
            <span
              style="
                font-family: 'Playfair Display', serif;
                font-weight: 700;
                color: var(--text-primary);
                font-size: 1.2rem;
              "
              >The Truth Gate</span
            >
          </a>
          <p
            style="
              color: var(--text-secondary);
              font-size: 0.9rem;
              line-height: 1.6;
            "
          >
            Raising a Burning Generation. Empowering believers to live
            passionately for Jesus.
          </p>
          <div style="display: flex; gap: 1rem; margin-top: 1rem">
            <a href="#" style="color: var(--text-secondary)"
              ><i class="fab fa-facebook"></i
            ></a>
            <a href="#" style="color: var(--text-secondary)"
              ><i class="fab fa-instagram"></i
            ></a>
            <a href="#" style="color: var(--text-secondary)"
              ><i class="fab fa-youtube"></i
            ></a>
          </div>
        </div>

        <!-- Quick Links -->
        <div>
          <h4
            style="
              font-family: var(--font-heading);
              margin-bottom: 1.25rem;
              color: var(--primary-dark);
            "
          >
            Quick Links
          </h4>
          <ul
            style="
              list-style: none;
              padding: 0;
              display: flex;
              flex-direction: column;
              gap: 0.75rem;
            "
          >
            <li>
              <a
                href="{% url 'home' %}"
                style="text-decoration: none; color: var(--text-secondary)"
                >Homepage</a
              >
            </li>
            <li>
              <a
                href="#about"
                style="text-decoration: none; color: var(--text-secondary)"
                >About Us</a
              >
            </li>
            <li>
              <a
                href="{% url 'event_list' %}"
                style="text-decoration: none; color: var(--text-secondary)"
                >Meetings</a
              >
            </li>
            <li>
              <a
                href="#"
                style="text-decoration: none; color: var(--text-secondary)"
                >Accommodation</a
              >
            </li>
            <!-- Placeholder -->
          </ul>
        </div>

        <!-- Community -->
        <div>
          <h4
            style="
              font-family: var(--font-heading);
              margin-bottom: 1.25rem;
              color: var(--primary-dark);
            "
          >
            Community
          </h4>
          <ul
            style="
              list-style: none;
              padding: 0;
              display: flex;
              flex-direction: column;
              gap: 0.75rem;
            "
          >
            <li>
              <a
                href="{% url 'login' %}"
                style="text-decoration: none; color: var(--text-secondary)"
                >Log In</a
              >
            </li>
            <li>
              <a
                href="{% url 'signup' %}"
                style="text-decoration: none; color: var(--text-secondary)"
                >Register</a
              >
            </li>
            <li>
              <a
                href="#"
                style="text-decoration: none; color: var(--text-secondary)"
                >Groups</a
              >
            </li>
          </ul>
        </div>

        <!-- Subscribe -->
        <div>
          <h4
            style="
              font-family: var(--font-heading);
              margin-bottom: 1.25rem;
              color: var(--primary-dark);
            "
          >
            Subscribe Our Newsletter
          </h4>
          <p
            style="
              color: var(--text-secondary);
              font-size: 0.9rem;
              margin-bottom: 1rem;
            "
          >
            Get Our Latest Update & News
          </p>
          <form
            onsubmit="event.preventDefault();"
            style="
              display: flex;
              background: white;
              border-radius: 50px;
              padding: 0.25rem;
              border: 1px solid var(--border-color);
            "
          >
            <input
              type="email"
              placeholder="Email"
              style="
                border: none;
                padding: 0.75rem 1rem;
                flex-grow: 1;
                border-radius: 50px;
                outline: none;
                background: transparent;
              "
            />
            <button
              type="submit"
              style="
                background: #10b981;
                color: white;
                border: none;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
              "
            >
              <i class="fas fa-arrow-right"></i>
            </button>
          </form>
        </div>
      </div>

      <div
        class="container"
        style="
          text-align: center;
          margin-top: 3rem;
          pt: 2rem;
          border-top: 1px solid var(--border-color);
          padding-top: 2rem;
        "
      >
        <p style="color: var(--text-secondary); font-size: 0.85rem">
          &copy; {% now "Y" %} The Truth Gate. All Rights Reserved.
        </p>
      </div>
    </footer>

    <!-- Mobile Bottom Navigation (Glass) -->
    <div
      class="bottom-nav glass-card"
      style="
        border-radius: 0;
        border-left: none;
        border-right: none;
        border-bottom: none;
      "
    >
      <a href="{% url 'home' %}" class="nav-item">
        <span class="material-icons-round">home</span>
        <span class="label">Home</span>
      </a>
      <a href="{% url 'sermon_list' %}" class="nav-item">
        <span class="material-icons-round">menu_book</span>
        <span class="label">Sermons</span>
      </a>
      <a href="{% url 'event_list' %}" class="nav-item">
        <span class="material-icons-round">calendar_month</span>
        <span class="label">Events</span>
      </a>
      <a href="{% url 'give' %}" class="nav-item">
        <span class="material-icons-round">favorite</span>
        <span class="label">Give</span>
      </a>
    </div>

    <script>
      function toggleMobileMenu() {
        document.querySelector(".mobile-overlay").classList.toggle("active");
        document.querySelector(".mobile-drawer").classList.toggle("active");
      }

      // Scroll Reveal Observer
      document.addEventListener("DOMContentLoaded", function () {
        // Fallback: If observer not supported, leave elements visible
        if (!('IntersectionObserver' in window)) return;

        const observerOptions = {
          root: null,
          rootMargin: "0px",
          threshold: 0.1,
        };

        const observer = new IntersectionObserver((entries, observer) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.remove("pending");
              entry.target.classList.add("active");
              observer.unobserve(entry.target);
            }
          });
        }, observerOptions);

        const revealElements = document.querySelectorAll(".reveal");
        revealElements.forEach((el) => {
           el.classList.add("pending"); // Hide only if JS runs
           observer.observe(el);
        });

        // Auto-dismiss Flash Messages
        setTimeout(function () {
          var messages = document.querySelectorAll('.flash-message');
          messages.forEach(function (msg) {
            msg.style.transition = "opacity 0.5s ease";
            msg.style.opacity = "0";
            setTimeout(function () {
              msg.remove();
            }, 500);
          });
        }, 4000);
      });
    </script>
  </body>
</html>
