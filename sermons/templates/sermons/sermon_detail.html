{% extends 'core/base.html' %}

{% block title %}{{ sermon.title }} | The Truth Gate{% endblock %}

{% block content %}
<article class="sermon-container container site-main">
    <header class="sermon-header text-center mb-4">
        <div class="sermon-meta mb-2">
            <span>{{ sermon.date_preached|date:"F d, Y" }}</span>
            {% if sermon.series %} â€¢ <span>Series: {{ sermon.series.title }}</span>{% endif %}
        </div>
        <h1 class="sermon-title">{{ sermon.title }}</h1>
        {% if sermon.speaker %}
        <p class="text-secondary">by {{ sermon.speaker.name }}</p>
        {% endif %}
    </header>

    <!-- Media removed from top (User request Step 1822) -->

    <!-- Notes/Content -->
    <section class="sermon-content">
        <h2 class="section-label">Sermon Notes</h2>
        
        {% if sermon.scripture_reference %}
        <blockquote class="scripture-block">
            <cite>{{ sermon.scripture_reference }}</cite>
        </blockquote>
        {% endif %}

        <div class="content">
            {{ sermon.notes|safe }}
        </div>
    </section>

    <!-- Sermon Actions (Watch/Listen) -->
    <section class="sermon-actions text-center" style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
        <h3 style="margin-bottom: 1.5rem; font-size: 1.2rem;">Media Resources</h3>
        
        <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem;">
            <!-- Watch Button -->
            {% if sermon.video_url %}
            <a href="{{ sermon.video_url }}" target="_blank" class="btn-watch">
                <span class="material-icons-round">play_circle</span> Watch Sermon
            </a>
            {% else %}
            <button class="btn-watch disabled" onclick="this.innerText = 'Video Unavailable'; this.style.opacity = '0.7';">
                <span class="material-icons-round">videocam_off</span> Watch Sermon
            </button>
            {% endif %}

            <!-- Listen Button / Player -->
            {% if sermon.audio_file %}
            <div style="width: 100%; max-width: 400px; margin-top: 1rem;">
                <audio controls style="width: 100%;">
                    <source src="{{ sermon.audio_file.url }}" type="audio/mpeg">
                    Your browser does not support the audio element.
                </audio>
            </div>
            {% endif %}
        </div>
    </section>

    <style>
        .btn-watch {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background-color: #e53935; /* Red */
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 600;
            border: 2px solid #e53935;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        .btn-watch:hover {
            background-color: white;
            color: #e53935;
        }
        .btn-watch.disabled {
            background-color: #f5f5f5;
            border-color: #dcdcdc;
            color: #999;
            cursor: not-allowed;
        }
        .btn-watch.disabled:hover {
            background-color: #f5f5f5;
            color: #999;
        }
    </style>

    <div class="sermon-footer text-center mt-4">
        <a href="{% url 'sermon_list' %}" class="back-link">&larr; Back to Library</a>
    </div>
</article>
{% endblock %}
